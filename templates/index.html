<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–º–µ—à–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π</title>
    
    <!-- –ò–ö–û–ù–ö–ê -->
    <link rel="icon" href="{{ url_for('static', filename='favicon.ico') }}" type="image/x-icon">
    <link rel="apple-touch-icon" href="{{ url_for('static', filename='apple-touch-icon.png') }}">
    
    <!-- –°—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <link href="https://fonts.googleapis.com/css2?family=Comic+Neue:wght@400;700&display=swap" rel="stylesheet">
    
    <!-- –ò–∫–æ–Ω–∫–∏ Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- –ú–µ—Ç–∞-—Ç–µ–≥–∏ -->
    <meta name="description" content="–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö —Å–º–µ—à–Ω—ã—Ö –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π">
    <meta name="keywords" content="–≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä, —Å–º–µ—à–Ω—ã–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è, —Ä—É—Å—Å–∫–∏–π —è–∑—ã–∫, –≥—Ä–∞–º–º–∞—Ç–∏–∫–∞">
    
    <!-- PWA –º–µ—Ç–∞—Ç–µ–≥–∏ -->
    <meta name="theme-color" content="#667eea">
    <link rel="manifest" href="{{ url_for('static', filename='manifest.json') }}">
    
    <!-- –°—Ç–∏–ª–∏ –¥–ª—è —Ç–µ–º—ã –∏ –∞–Ω–∏–º–∞—Ü–∏–π -->
    <style>
        .theme-icon {
            display: none;
        }
        
        .theme-icon.active {
            display: block;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–∞—Å–∫–∏ —Å–º–∞–π–ª–∏–∫–∞ */
        .emoji-mask {
            font-size: 2.8em;
            display: inline-block;
            animation: bounce 1s infinite alternate;
        }
        
        /* –°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞ - –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π */
        [data-theme="light"] .emoji-mask {
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        /* –¢—ë–º–Ω–∞—è —Ç–µ–º–∞ - —Ñ–∏–æ–ª–µ—Ç–æ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç */
        [data-theme="dark"] .emoji-mask {
            background: linear-gradient(135deg, 
                #8a63d2 0%, 
                #9d77e0 25%, 
                #c471ed 50%, 
                #9d77e0 75%, 
                #8a63d2 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
            text-shadow: 0 0 15px rgba(138, 99, 210, 0.6);
        }
        
        /* –û–±—â–∞—è –∞–Ω–∏–º–∞—Ü–∏—è bounce –¥–ª—è –í–°–ï–• —ç–º–æ–¥–∑–∏ */
        .emoji {
            font-size: 1.5em;
            display: inline-block;
            animation: bounce 1s infinite alternate;
        }
        
        /* –ö–ª—é—á–µ–≤—ã–µ –∫–∞–¥—Ä—ã –∞–Ω–∏–º–∞—Ü–∏–∏ bounce */
        @keyframes bounce {
            from { transform: translateY(0); }
            to { transform: translateY(-10px); }
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ */
        .favorite-btn {
            background: none;
            border: none;
            font-size: 1.5em;
            cursor: pointer;
            padding: 5px;
            margin-left: 10px;
            transition: all 0.3s;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .favorite-btn:hover {
            background: rgba(255, 65, 108, 0.1);
            transform: scale(1.1);
        }
        
        .favorite-btn.active {
            color: #ff416c;
            animation: heartbeat 0.5s;
        }
        
        @keyframes heartbeat {
            0% { transform: scale(1); }
            25% { transform: scale(1.2); }
            50% { transform: scale(1); }
            75% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ */
        .history-favorites-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-top: 20px;
        }
        
        @media (max-width: 768px) {
            .history-favorites-container {
                grid-template-columns: 1fr;
            }
        }
        
        .section-card {
            background: var(--light);
            border-radius: 15px;
            padding: 20px;
            border: 2px solid var(--primary);
            max-height: 300px;
            overflow-y: auto;
        }
        
        .section-card h3 {
            margin-top: 0;
            color: var(--secondary);
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .empty-message {
            text-align: center;
            color: #888;
            padding: 20px;
            font-style: italic;
        }
        
        .history-item, .favorite-item {
            padding: 10px;
            margin: 8px 0;
            background: var(--card-bg);
            border-radius: 8px;
            border-left: 3px solid var(--secondary);
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: transform 0.2s;
        }
        
        .history-item:hover, .favorite-item:hover {
            transform: translateX(5px);
            background: var(--stats-bg);
        }
        
        .history-text, .favorite-text {
            flex-grow: 1;
            cursor: pointer;
            padding: 5px;
        }
        
        .history-time {
            font-size: 0.8em;
            color: #888;
            margin-left: 10px;
        }
        
        .remove-btn {
            background: none;
            border: none;
            color: #ff6b6b;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .remove-btn:hover {
            background: rgba(255, 107, 107, 0.1);
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤–∫–ª–∞–¥–æ–∫ */
        .tabs {
            display: flex;
            margin-top: 20px;
            border-bottom: 2px solid var(--stats-bg);
        }
        
        .tab-btn {
            padding: 12px 24px;
            background: none;
            border: none;
            font-size: 1.1em;
            cursor: pointer;
            color: var(--text-color);
            opacity: 0.7;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        .tab-btn.active {
            opacity: 1;
            border-bottom: 3px solid var(--primary);
            color: var(--primary);
        }
        
        .tab-btn:hover {
            opacity: 1;
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.3s ease;
        }
        
        .tab-content.active {
            display: block;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ö–Ω–æ–ø–∫–∞ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è —Ç–µ–º—ã -->
        <button id="theme-toggle" class="theme-toggle" aria-label="–ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–µ–º—É">
            <span class="theme-icon active" id="sun-icon">‚òÄÔ∏è</span>
            <span class="theme-icon" id="moon-icon">üåô</span>
        </button>
        
        <h1><span class="emoji-mask">üé≠</span> –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä —Å–º–µ—à–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π</h1>
        <p class="subtitle">–ö–∞–∂–¥–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ –≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–µ—Ä–Ω–æ!</p>
        
        <!-- –í–∫–ª–∞–¥–∫–∏ -->
        <div class="tabs">
            <button id="tab-generate" class="tab-btn active">
                <i class="fas fa-dice"></i> –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä
            </button>
            <button id="tab-history" class="tab-btn">
                <i class="fas fa-history"></i> –ò—Å—Ç–æ—Ä–∏—è
            </button>
            <button id="tab-favorites" class="tab-btn">
                <i class="fas fa-heart"></i> –ò–∑–±—Ä–∞–Ω–Ω–æ–µ
            </button>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞ -->
        <div id="tab-content-generate" class="tab-content active">
            <div class="card">
                <div style="display: flex; align-items: center; justify-content: center;">
                    <div id="sentence" class="sentence" style="cursor: pointer; flex-grow: 1;">
                        –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏...
                    </div>
                    <button id="favorite-btn" class="favorite-btn" title="–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ">
                        <i class="far fa-heart"></i>
                    </button>
                </div>
                <div id="words" class="words" style="display: none;">
                    <strong>–ò—Å—Ö–æ–¥–Ω—ã–µ —Å–ª–æ–≤–∞:</strong>
                    <div id="word-list"></div>
                </div>
            </div>
            
            <div class="buttons">
                <button id="generate-btn">
                    <span class="emoji">üé≤</span> –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å!
                </button>
                <button id="auto-btn">
                    <span class="emoji">‚ñ∂Ô∏è</span> –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è
                </button>
                <button id="copy-btn">
                    <span class="emoji">üìã</span> –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å
                </button>
                <button id="show-words-btn">
                    <span class="emoji">üîç</span> –ü–æ–∫–∞–∑–∞—Ç—å —Å–ª–æ–≤–∞
                </button>
            </div>
            
            <!-- –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥–ª—è –∞–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ -->
            <div id="progress-container" class="progress-container">
                <div class="progress-header">
                    <small>–°–ª–µ–¥—É—é—â–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑:</small>
                    <small id="countdown">8 —Å–µ–∫</small>
                </div>
                <div class="progress-track">
                    <div id="progress-bar" class="progress-bar"></div>
                </div>
            </div>
            
            <div class="stats">
                –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ: <span id="counter">0</span> –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–π | 
                –í—Å–µ–≥–æ –∫–æ–º–±–∏–Ω–∞—Ü–∏–π: <span id="total-combinations">810,000</span>
                <br>
                <span id="auto-status" style="font-size: 0.9em; opacity: 0.8;">–ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—ã–∫–ª—é—á–µ–Ω–∞</span>
            </div>
            
            <!-- –°–µ–∫—Ü–∏—è –≥–æ—Ä—è—á–∏—Ö –∫–ª–∞–≤–∏—à -->
            <div class="hotkeys-info">
                <h3><span class="emoji">‚å®Ô∏è</span> –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏:</h3>
                <div class="hotkeys-grid">
                    <div class="hotkey-item">
                        <kbd>Space</kbd> –∏–ª–∏ <kbd>Enter</kbd>
                        <span>–ù–æ–≤–∞—è —Ñ—Ä–∞–∑–∞</span>
                    </div>
                    <div class="hotkey-item">
                        <kbd>Alt</kbd> + <kbd>T</kbd>
                        <span>–°–º–µ–Ω–∏—Ç—å —Ç–µ–º—É</span>
                    </div>
                    <div class="hotkey-item">
                        <kbd>Alt</kbd> + <kbd>A</kbd>
                        <span>–ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è</span>
                    </div>
                    <div class="hotkey-item">
                        <kbd>Ctrl</kbd> + <kbd>C</kbd>
                        <span>–ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Ñ—Ä–∞–∑—É</span>
                    </div>
                    <div class="hotkey-item">
                        <kbd>Alt</kbd> + <kbd>W</kbd>
                        <span>–ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å —Å–ª–æ–≤–∞</span>
                    </div>
                    <div class="hotkey-item">
                        <kbd>Alt</kbd> + <kbd>F</kbd>
                        <span>–í –∏–∑–±—Ä–∞–Ω–Ω–æ–µ</span>
                    </div>
                    <div class="hotkey-item">
                        <span class="mouse-hint">üëÜ –ö–ª–∏–∫ –Ω–∞ —Ñ—Ä–∞–∑—É</span>
                        <span>–ù–æ–≤–∞—è —Ñ—Ä–∞–∑–∞</span>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ –ò—Å—Ç–æ—Ä–∏–∏ -->
        <div id="tab-content-history" class="tab-content">
            <div class="section-card">
                <h3><i class="fas fa-history"></i> –ü–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Ñ—Ä–∞–∑</h3>
                <div id="history-list">
                    <div class="empty-message">
                        –ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –ø–µ—Ä–≤—É—é —Ñ—Ä–∞–∑—É!
                    </div>
                </div>
            </div>
            <div class="info">
                <p>üìù –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –ª—é–±—É—é —Ñ—Ä–∞–∑—É –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –µ—ë —Å–Ω–æ–≤–∞ –≤ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–µ</p>
                <p>‚è∞ –ò—Å—Ç–æ—Ä–∏—è —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –¥–æ –∑–∞–∫—Ä—ã—Ç–∏—è –±—Ä–∞—É–∑–µ—Ä–∞</p>
            </div>
        </div>
        
        <!-- –í–∫–ª–∞–¥–∫–∞ –ò–∑–±—Ä–∞–Ω–Ω–æ–≥–æ -->
        <div id="tab-content-favorites" class="tab-content">
            <div class="section-card">
                <h3><i class="fas fa-heart"></i> –ò–∑–±—Ä–∞–Ω–Ω—ã–µ —Ñ—Ä–∞–∑—ã</h3>
                <div id="favorites-list">
                    <div class="empty-message">
                        –í –∏–∑–±—Ä–∞–Ω–Ω–æ–º –ø–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é —Ñ—Ä–∞–∑—É!
                    </div>
                </div>
            </div>
            <div class="info">
                <p>üíñ –ò–∑–±—Ä–∞–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ</p>
                <p>üóëÔ∏è –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∫–æ—Ä–∑–∏–Ω—É, —á—Ç–æ–±—ã —É–¥–∞–ª–∏—Ç—å —Ñ—Ä–∞–∑—É –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ</p>
                <p>üìã –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ —Ñ—Ä–∞–∑—É, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –µ—ë –≤ –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–µ</p>
            </div>
        </div>
        
        <div class="info">
            <p>‚ú® –ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç pymorphy3 –¥–ª—è –≥—Ä–∞–º–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —Å–∫–ª–æ–Ω–µ–Ω–∏—è —Å–ª–æ–≤</p>
            <p>üåô –ù–∞–∂–º–∏ –Ω–∞ —Å–æ–ª–Ω—ã—à–∫–æ/–ª—É–Ω—É –¥–ª—è —Å–º–µ–Ω—ã —Ç–µ–º—ã</p>
            <p>‚ö° –ù–∞–∂–º–∏ "–ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è" –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π —Å–º–µ–Ω—ã —Ñ—Ä–∞–∑ –∫–∞–∂–¥—ã–µ <strong>8 —Å–µ–∫—É–Ω–¥</strong></p>
            <p>üñ±Ô∏è –ö–ª–∏–∫–Ω–∏ –Ω–∞ —Ñ—Ä–∞–∑—É –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –Ω–æ–≤–æ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏</p>
            <p id="install-prompt" style="display: none;">
                üì± <a href="#" id="install-btn" style="color: var(--primary); font-weight: bold;">–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ</a> –¥–ª—è —Ä–∞–±–æ—Ç—ã –æ—Ñ—Ñ–ª–∞–π–Ω
            </p>
        </div>
    </div>

    <script>
        // === –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–º–æ–π ===
        function detectSystemTheme() {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                return 'dark';
            }
            return 'light';
        }

        function initTheme() {
            const savedTheme = localStorage.getItem('theme');
            let theme;
            
            if (savedTheme) {
                theme = savedTheme;
            } else {
                theme = detectSystemTheme();
            }
            
            document.documentElement.setAttribute('data-theme', theme);
            updateThemeIcon(theme);
        }
        
        function toggleTheme() {
            const currentTheme = document.documentElement.getAttribute('data-theme');
            const newTheme = currentTheme === 'light' ? 'dark' : 'light';
            
            document.documentElement.setAttribute('data-theme', newTheme);
            localStorage.setItem('theme', newTheme);
            updateThemeIcon(newTheme);
            
            themeToggle.style.transform = 'rotate(360deg)';
            setTimeout(() => {
                themeToggle.style.transform = '';
            }, 300);
        }
        
        function updateThemeIcon(theme) {
            if (theme === 'dark') {
                sunIcon.classList.remove('active');
                moonIcon.classList.add('active');
                themeToggle.setAttribute('aria-label', '–í–∫–ª—é—á–∏—Ç—å —Å–≤–µ—Ç–ª—É—é —Ç–µ–º—É');
            } else {
                moonIcon.classList.remove('active');
                sunIcon.classList.add('active');
                themeToggle.setAttribute('aria-label', '–í–∫–ª—é—á–∏—Ç—å —Ç—ë–º–Ω—É—é —Ç–µ–º—É');
            }
        }

        // –°–ª—É—à–∞–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–Ω–æ–π —Ç–µ–º—ã
        if (window.matchMedia) {
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
                if (!localStorage.getItem('theme')) {
                    const newTheme = e.matches ? 'dark' : 'light';
                    document.documentElement.setAttribute('data-theme', newTheme);
                    updateThemeIcon(newTheme);
                }
            });
        }
        
        // === –û—Å–Ω–æ–≤–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ ===
        const generateBtn = document.getElementById('generate-btn');
        const autoBtn = document.getElementById('auto-btn');
        const copyBtn = document.getElementById('copy-btn');
        const showWordsBtn = document.getElementById('show-words-btn');
        const favoriteBtn = document.getElementById('favorite-btn');
        const themeToggle = document.getElementById('theme-toggle');
        const sunIcon = document.getElementById('sun-icon');
        const moonIcon = document.getElementById('moon-icon');
        const sentenceEl = document.getElementById('sentence');
        const wordsEl = document.getElementById('words');
        const wordListEl = document.getElementById('word-list');
        const counterEl = document.getElementById('counter');
        const totalEl = document.getElementById('total-combinations');
        const autoStatusEl = document.getElementById('auto-status');
        const progressContainer = document.getElementById('progress-container');
        const progressBar = document.getElementById('progress-bar');
        const countdownEl = document.getElementById('countdown');
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –≤–∫–ª–∞–¥–æ–∫
        const tabGenerateBtn = document.getElementById('tab-generate');
        const tabHistoryBtn = document.getElementById('tab-history');
        const tabFavoritesBtn = document.getElementById('tab-favorites');
        const tabContentGenerate = document.getElementById('tab-content-generate');
        const tabContentHistory = document.getElementById('tab-content-history');
        const tabContentFavorites = document.getElementById('tab-content-favorites');
        
        // –≠–ª–µ–º–µ–Ω—Ç—ã –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
        const historyListEl = document.getElementById('history-list');
        const favoritesListEl = document.getElementById('favorites-list');
        
        // –¢–µ–∫—É—â–∞—è —Ñ—Ä–∞–∑–∞ –∏ –µ—ë –¥–∞–Ω–Ω—ã–µ
        let currentSentence = '';
        let currentWords = null;
        let currentSentenceId = null;
        
        // –°–æ—Å—Ç–æ—è–Ω–∏–µ
        let showWords = false;
        let autoInterval = null;
        let countdownInterval = null;
        let isAutoGenerating = false;
        const AUTO_INTERVAL_MS = 8000; // 8 —Å–µ–∫—É–Ω–¥
        let timeLeft = AUTO_INTERVAL_MS;
        let progress = 0;
        
        // –ò—Å—Ç–æ—Ä–∏—è –∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
        let history = JSON.parse(localStorage.getItem('phraseHistory') || '[]');
        let favorites = JSON.parse(localStorage.getItem('phraseFavorites') || '[]');
        
        // === –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏ –∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ ===
        function saveToHistory(sentence, words) {
            const historyItem = {
                id: Date.now(),
                sentence: sentence,
                words: words,
                timestamp: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                date: new Date().toLocaleDateString()
            };
            
            history.unshift(historyItem);
            
            // –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é 10 —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏
            if (history.length > 10) {
                history = history.slice(0, 10);
            }
            
            localStorage.setItem('phraseHistory', JSON.stringify(history));
            updateHistoryDisplay();
        }
        
        function toggleFavorite() {
            if (!currentSentenceId || !currentSentence) return;
            
            const existingIndex = favorites.findIndex(f => f.id === currentSentenceId);
            
            if (existingIndex !== -1) {
                // –£–¥–∞–ª—è–µ–º –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
                favorites.splice(existingIndex, 1);
                favoriteBtn.innerHTML = '<i class="far fa-heart"></i>';
                favoriteBtn.classList.remove('active');
                favoriteBtn.title = '–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ';
                showNotification('–£–¥–∞–ª–µ–Ω–æ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ üíî', 'info');
            } else {
                // –î–æ–±–∞–≤–ª—è–µ–º –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
                const favoriteItem = {
                    id: currentSentenceId,
                    sentence: currentSentence,
                    words: currentWords,
                    timestamp: new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}),
                    date: new Date().toLocaleDateString(),
                    added: Date.now()
                };
                
                favorites.unshift(favoriteItem);
                favoriteBtn.innerHTML = '<i class="fas fa-heart"></i>';
                favoriteBtn.classList.add('active');
                favoriteBtn.title = '–£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ';
                showNotification('–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ üíñ', 'success');
            }
            
            localStorage.setItem('phraseFavorites', JSON.stringify(favorites));
            updateFavoritesDisplay();
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏, –µ—Å–ª–∏ –º—ã –Ω–∞ –≤–∫–ª–∞–¥–∫–µ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
            if (tabContentFavorites.classList.contains('active')) {
                updateFavoritesDisplay();
            }
        }
        
        function removeFromFavorites(id) {
            favorites = favorites.filter(f => f.id !== id);
            localStorage.setItem('phraseFavorites', JSON.stringify(favorites));
            updateFavoritesDisplay();
            
            // –ï—Å–ª–∏ —É–¥–∞–ª–∏–ª–∏ —Ç–µ–∫—É—â—É—é —Ñ—Ä–∞–∑—É, –æ–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É
            if (currentSentenceId === id) {
                favoriteBtn.innerHTML = '<i class="far fa-heart"></i>';
                favoriteBtn.classList.remove('active');
                favoriteBtn.title = '–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ';
            }
            
            showNotification('–£–¥–∞–ª–µ–Ω–æ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ üóëÔ∏è', 'info');
        }
        
        function updateHistoryDisplay() {
            if (history.length === 0) {
                historyListEl.innerHTML = '<div class="empty-message">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞. –°–≥–µ–Ω–µ—Ä–∏—Ä—É–π—Ç–µ –ø–µ—Ä–≤—É—é —Ñ—Ä–∞–∑—É!</div>';
                return;
            }
            
            historyListEl.innerHTML = history.map(item => `
                <div class="history-item" data-id="${item.id}">
                    <div class="history-text" title="–ö–ª–∏–∫–Ω–∏—Ç–µ, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å">${item.sentence}</div>
                    <div class="history-time">${item.timestamp}</div>
                </div>
            `).join('');
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã –∏—Å—Ç–æ—Ä–∏–∏
            document.querySelectorAll('.history-text').forEach((el, index) => {
                el.addEventListener('click', () => {
                    const item = history[index];
                    sentenceEl.textContent = item.sentence;
                    currentSentence = item.sentence;
                    currentWords = item.words;
                    currentSentenceId = item.id;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ª–æ–≤
                    if (item.words) {
                        wordListEl.innerHTML = `
                            –°—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ: <strong>${item.words.noun}</strong><br>
                            –ì–ª–∞–≥–æ–ª: <strong>${item.words.verb}</strong><br>
                            –ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω–æ–µ: <strong>${item.words.adjective}</strong><br>
                            –ú–µ—Å—Ç–æ: <strong>${item.words.place}</strong>
                        `;
                    }
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
                    const isFavorite = favorites.some(f => f.id === item.id);
                    favoriteBtn.innerHTML = isFavorite ? '<i class="fas fa-heart"></i>' : '<i class="far fa-heart"></i>';
                    favoriteBtn.classList.toggle('active', isFavorite);
                    favoriteBtn.title = isFavorite ? '–£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ' : '–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ';
                    
                    // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
                    switchTab('generate');
                    showNotification('–§—Ä–∞–∑–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ üîÑ', 'info');
                });
            });
        }
        
        function updateFavoritesDisplay() {
            if (favorites.length === 0) {
                favoritesListEl.innerHTML = '<div class="empty-message">–í –∏–∑–±—Ä–∞–Ω–Ω–æ–º –ø–æ–∫–∞ –Ω–∏—á–µ–≥–æ –Ω–µ—Ç. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–≤—É—é —Ñ—Ä–∞–∑—É!</div>';
                return;
            }
            
            favoritesListEl.innerHTML = favorites.map(item => `
                <div class="favorite-item" data-id="${item.id}">
                    <div class="favorite-text" title="–ö–ª–∏–∫–Ω–∏—Ç–µ, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å">${item.sentence}</div>
                    <button class="remove-btn" title="–£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ">
                        <i class="fas fa-trash"></i>
                    </button>
                </div>
            `).join('');
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤ –Ω–∞ —ç–ª–µ–º–µ–Ω—Ç—ã –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
            document.querySelectorAll('.favorite-text').forEach((el, index) => {
                el.addEventListener('click', () => {
                    const item = favorites[index];
                    sentenceEl.textContent = item.sentence;
                    currentSentence = item.sentence;
                    currentWords = item.words;
                    currentSentenceId = item.id;
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ª–æ–≤
                    if (item.words) {
                        wordListEl.innerHTML = `
                            –°—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ: <strong>${item.words.noun}</strong><br>
                            –ì–ª–∞–≥–æ–ª: <strong>${item.words.verb}</strong><br>
                            –ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω–æ–µ: <strong>${item.words.adjective}</strong><br>
                            –ú–µ—Å—Ç–æ: <strong>${item.words.place}</strong>
                        `;
                    }
                    
                    // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
                    favoriteBtn.innerHTML = '<i class="fas fa-heart"></i>';
                    favoriteBtn.classList.add('active');
                    favoriteBtn.title = '–£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ';
                    
                    // –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä–∞
                    switchTab('generate');
                    showNotification('–§—Ä–∞–∑–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ üíñ', 'info');
                });
            });
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –Ω–∞ –∫–Ω–æ–ø–∫–∏ —É–¥–∞–ª–µ–Ω–∏—è
            document.querySelectorAll('.remove-btn').forEach((btn, index) => {
                btn.addEventListener('click', (e) => {
                    e.stopPropagation();
                    const item = favorites[index];
                    removeFromFavorites(item.id);
                });
            });
        }
        
        function showNotification(message, type = 'info') {
            // –°–æ–∑–¥–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.innerHTML = `
                <span>${message}</span>
                <button class="notification-close">&times;</button>
            `;
            
            // –°—Ç–∏–ª–∏ –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#4CAF50' : type === 'error' ? '#f44336' : '#2196F3'};
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                display: flex;
                align-items: center;
                justify-content: space-between;
                min-width: 300px;
                animation: slideIn 0.3s ease;
            `;
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è
            const style = document.createElement('style');
            style.textContent = `
                @keyframes slideIn {
                    from { transform: translateX(100%); opacity: 0; }
                    to { transform: translateX(0); opacity: 1; }
                }
                @keyframes slideOut {
                    from { transform: translateX(0); opacity: 1; }
                    to { transform: translateX(100%); opacity: 0; }
                }
                .notification-close {
                    background: none;
                    border: none;
                    color: white;
                    font-size: 1.5em;
                    cursor: pointer;
                    padding: 0;
                    margin-left: 15px;
                }
            `;
            document.head.appendChild(style);
            
            // –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
            notification.querySelector('.notification-close').addEventListener('click', () => {
                notification.style.animation = 'slideOut 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            });
            
            document.body.appendChild(notification);
            
            // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.style.animation = 'slideOut 0.3s ease';
                    setTimeout(() => notification.remove(), 300);
                }
            }, 3000);
        }
        
        // === –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∫–ª–∞–¥–∫–∞–º–∏ ===
        function switchTab(tabName) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏
            [tabContentGenerate, tabContentHistory, tabContentFavorites].forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –∫–Ω–æ–ø–æ–∫
            [tabGenerateBtn, tabHistoryBtn, tabFavoritesBtn].forEach(btn => {
                btn.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –≤–∫–ª–∞–¥–∫—É
            switch(tabName) {
                case 'generate':
                    tabContentGenerate.classList.add('active');
                    tabGenerateBtn.classList.add('active');
                    break;
                case 'history':
                    tabContentHistory.classList.add('active');
                    tabHistoryBtn.classList.add('active');
                    updateHistoryDisplay();
                    break;
                case 'favorites':
                    tabContentFavorites.classList.add('active');
                    tabFavoritesBtn.classList.add('active');
                    updateFavoritesDisplay();
                    break;
            }
        }
        
        // === –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è ===
        async function generateSentence() {
            try {
                sentenceEl.textContent = '–ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º...';
                sentenceEl.style.opacity = '0.7';
                
                const response = await fetch('/generate');
                const data = await response.json();
                
                sentenceEl.textContent = data.sentence;
                sentenceEl.style.opacity = '1';
                sentenceEl.classList.add('new-sentence');
                
                setTimeout(() => {
                    sentenceEl.classList.remove('new-sentence');
                }, 500);
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â—É—é —Ñ—Ä–∞–∑—É
                currentSentence = data.sentence;
                currentWords = data.words;
                currentSentenceId = Date.now();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å–ª–æ–≤
                wordListEl.innerHTML = `
                    –°—É—â–µ—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ–µ: <strong>${data.words.noun}</strong><br>
                    –ì–ª–∞–≥–æ–ª: <strong>${data.words.verb}</strong><br>
                    –ü—Ä–∏–ª–∞–≥–∞—Ç–µ–ª—å–Ω–æ–µ: <strong>${data.words.adjective}</strong><br>
                    –ú–µ—Å—Ç–æ: <strong>${data.words.place}</strong>
                `;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á—ë—Ç—á–∏–∫
                counterEl.textContent = data.stats.total;
                totalEl.textContent = data.stats.combinations.toLocaleString();
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∫–Ω–æ–ø–∫—É –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
                const isFavorite = favorites.some(f => f.sentence === data.sentence);
                favoriteBtn.innerHTML = isFavorite ? '<i class="fas fa-heart"></i>' : '<i class="far fa-heart"></i>';
                favoriteBtn.classList.toggle('active', isFavorite);
                favoriteBtn.title = isFavorite ? '–£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ' : '–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ';
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –∏—Å—Ç–æ—Ä–∏—é
                saveToHistory(data.sentence, data.words);
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ª–æ–≤–∞ –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω–æ
                wordsEl.style.display = showWords ? 'block' : 'none';
                
            } catch (error) {
                sentenceEl.textContent = '–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ üò¢';
                console.error('–û—à–∏–±–∫–∞:', error);
                if (isAutoGenerating) {
                    toggleAutoGeneration();
                }
            }
        }
        
        // === –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä–æ–º ===
        function startProgressAnimation() {
            if (!isAutoGenerating) return;
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –ü–ï–†–ï–î –Ω–∞—á–∞–ª–æ–º –∞–Ω–∏–º–∞—Ü–∏–∏
            progressBar.style.transition = 'none';
            progressBar.style.width = '0%';
            
            // –î–∞—ë–º –±—Ä–∞—É–∑–µ—Ä—É –≤—Ä–µ–º—è –ø—Ä–∏–º–µ–Ω–∏—Ç—å —Å–±—Ä–æ—Å
            requestAnimationFrame(() => {
                requestAnimationFrame(() => {
                    // –í–∫–ª—é—á–∞–µ–º –ø–ª–∞–≤–Ω—É—é –∞–Ω–∏–º–∞—Ü–∏—é
                    progressBar.style.transition = `width ${AUTO_INTERVAL_MS}ms linear`;
                    // –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –∑–∞–ø–æ–ª–Ω–µ–Ω–∏—è –¥–æ 100%
                    progressBar.style.width = '100%';
                });
            });
        }
        
        function updateCountdown() {
            if (!isAutoGenerating) return;
            
            timeLeft -= 1000;
            countdownEl.textContent = `${timeLeft / 1000} —Å–µ–∫`;
            
            if (timeLeft <= 0) {
                timeLeft = AUTO_INTERVAL_MS;
                countdownEl.textContent = '8 —Å–µ–∫';
            }
        }
        
        // === –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è ===
        function toggleAutoGeneration() {
            if (isAutoGenerating) {
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å—ë
                clearInterval(autoInterval);
                clearInterval(countdownInterval);
                
                autoBtn.innerHTML = '<span class="emoji">‚ñ∂Ô∏è</span> –ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è';
                autoBtn.style.background = 'linear-gradient(to right, var(--primary), var(--secondary))';
                autoStatusEl.textContent = '–ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤—ã–∫–ª—é—á–µ–Ω–∞';
                autoStatusEl.style.color = '';
                autoBtn.classList.remove('active');
                progressContainer.style.display = 'none';
                isAutoGenerating = false;
            } else {
                // –ó–∞–ø—É—Å–∫–∞–µ–º
                autoBtn.innerHTML = '<span class="emoji">‚è∏Ô∏è</span> –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å';
                autoBtn.style.background = 'linear-gradient(to right, #ff416c, #ff4b2b)';
                autoStatusEl.textContent = '–ê–≤—Ç–æ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–∫–ª—é—á–µ–Ω–∞ (–∫–∞–∂–¥—ã–µ 8 —Å–µ–∫—É–Ω–¥)';
                autoStatusEl.style.color = '#ff416c';
                autoBtn.classList.add('active');
                progressContainer.style.display = 'block';
                isAutoGenerating = true;
                
                // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ç–∞–π–º–µ—Ä
                timeLeft = AUTO_INTERVAL_MS;
                countdownEl.textContent = '8 —Å–µ–∫';
                
                // –ü–µ—Ä–≤–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
                generateSentence();
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä (—Å–±—Ä–∞—Å—ã–≤–∞–µ–º –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º)
                startProgressAnimation();
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±—Ä–∞—Ç–Ω—ã–π –æ—Ç—Å—á—ë—Ç
                countdownInterval = setInterval(updateCountdown, 1000);
                
                // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏
                autoInterval = setInterval(() => {
                    // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤–æ–µ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
                    generateSentence();
                    
                    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –ü–ï–†–ï–î –Ω–∞—á–∞–ª–æ–º –Ω–æ–≤–æ–≥–æ —Ü–∏–∫–ª–∞
                    startProgressAnimation();
                    
                    // –°–±—Ä–∞—Å—ã–≤–∞–µ–º –æ—Ç—Å—á—ë—Ç
                    timeLeft = AUTO_INTERVAL_MS;
                    countdownEl.textContent = '8 —Å–µ–∫';
                    
                }, AUTO_INTERVAL_MS);
            }
        }
        
        // === –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ ===
        function copyToClipboard() {
            const text = sentenceEl.textContent;
            navigator.clipboard.writeText(text).then(() => {
                const originalText = copyBtn.innerHTML;
                copyBtn.innerHTML = '<span class="emoji">‚úÖ</span> –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ!';
                copyBtn.style.background = 'linear-gradient(to right, #4CAF50, #2E7D32)';
                
                setTimeout(() => {
                    copyBtn.innerHTML = originalText;
                    copyBtn.style.background = 'linear-gradient(to right, #f093fb, #f5576c)';
                }, 2000);
                
                showNotification('–§—Ä–∞–∑–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞ –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞ üìã', 'success');
            });
        }
        
        // === –ü–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å —Å–ª–æ–≤–∞ ===
        function toggleWords() {
            showWords = !showWords;
            wordsEl.style.display = showWords ? 'block' : 'none';
            showWordsBtn.innerHTML = showWords 
                ? '<span class="emoji">üëÅÔ∏è</span> –°–∫—Ä—ã—Ç—å —Å–ª–æ–≤–∞' 
                : '<span class="emoji">üîç</span> –ü–æ–∫–∞–∑–∞—Ç—å —Å–ª–æ–≤–∞';
        }
        
        // === –ö–ª–∏–∫ –Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ ===
        function handleSentenceClick() {
            generateSentence();
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –∫–ª–∏–∫–∞
            sentenceEl.style.transform = 'scale(0.98)';
            setTimeout(() => {
                sentenceEl.style.transform = 'scale(1)';
            }, 150);
        }
        
        // === PWA —É—Å—Ç–∞–Ω–æ–≤–∫–∞ ===
        let deferredPrompt;
        const installBtn = document.getElementById('install-btn');
        const installPrompt = document.getElementById('install-prompt');
        
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            installPrompt.style.display = 'block';
        });
        
        if (installBtn) {
            installBtn.addEventListener('click', async () => {
                if (!deferredPrompt) return;
                
                deferredPrompt.prompt();
                const { outcome } = await deferredPrompt.userChoice;
                
                if (outcome === 'accepted') {
                    installPrompt.style.display = 'none';
                    showNotification('–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ! üì±', 'success');
                }
                
                deferredPrompt = null;
            });
        }
        
        // === –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π ===
        generateBtn.addEventListener('click', generateSentence);
        autoBtn.addEventListener('click', toggleAutoGeneration);
        copyBtn.addEventListener('click', copyToClipboard);
        showWordsBtn.addEventListener('click', toggleWords);
        favoriteBtn.addEventListener('click', toggleFavorite);
        themeToggle.addEventListener('click', toggleTheme);
        sentenceEl.addEventListener('click', handleSentenceClick);
        
        // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤–∫–ª–∞–¥–æ–∫
        tabGenerateBtn.addEventListener('click', () => switchTab('generate'));
        tabHistoryBtn.addEventListener('click', () => switchTab('history'));
        tabFavoritesBtn.addEventListener('click', () => switchTab('favorites'));
        
        // === –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ===
        window.addEventListener('load', () => {
            initTheme();
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –∏—Å—Ç–æ—Ä–∏—é –∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
            updateHistoryDisplay();
            updateFavoritesDisplay();
            
            // –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
            setTimeout(() => {
                generateSentence();
                sentenceEl.style.cursor = 'pointer';
                sentenceEl.title = '–ö–ª–∏–∫–Ω–∏ –¥–ª—è –Ω–æ–≤–æ–π —Ñ—Ä–∞–∑—ã!';
            }, 300);
            
            fetch('/generate')
                .then(res => res.json())
                .then(data => {
                    totalEl.textContent = data.stats.combinations.toLocaleString();
                });
        });
        
        // === –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ ===
        document.addEventListener('keydown', (e) => {
            if (e.code === 'Space' || e.code === 'Enter') {
                e.preventDefault();
                generateSentence();
                // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–π –æ–±—Ä–∞—Ç–Ω–æ–π —Å–≤—è–∑–∏
                document.activeElement.blur();
                generateBtn.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    generateBtn.style.transform = '';
                }, 150);
            }
            if (e.code === 'KeyC' && (e.ctrlKey || e.metaKey)) {
                e.preventDefault();
                copyToClipboard();
            }
            if (e.code === 'KeyT' && e.altKey) {
                e.preventDefault();
                toggleTheme();
            }
            if (e.code === 'KeyA' && e.altKey) {
                e.preventDefault();
                toggleAutoGeneration();
            }
            if (e.code === 'KeyW' && e.altKey) {
                e.preventDefault();
                toggleWords();
                // –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∫–Ω–æ–ø–∫–∏
                showWordsBtn.style.transform = 'scale(0.95)';
                setTimeout(() => {
                    showWordsBtn.style.transform = '';
                }, 150);
            }
            if (e.code === 'KeyF' && e.altKey) {
                e.preventDefault();
                toggleFavorite();
            }
            if (e.code === 'Digit1' && e.altKey) {
                e.preventDefault();
                switchTab('generate');
            }
            if (e.code === 'Digit2' && e.altKey) {
                e.preventDefault();
                switchTab('history');
            }
            if (e.code === 'Digit3' && e.altKey) {
                e.preventDefault();
                switchTab('favorites');
            }
        });
        
        // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–∏ —É—Ö–æ–¥–µ —Å–æ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        window.addEventListener('beforeunload', () => {
            if (isAutoGenerating) {
                clearInterval(autoInterval);
                clearInterval(countdownInterval);
            }
        });
        
        // –ü–æ–¥—Å–∫–∞–∑–∫–∞ –ø—Ä–∏ –Ω–∞–≤–µ–¥–µ–Ω–∏–∏ –Ω–∞ –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏–µ
        sentenceEl.addEventListener('mouseenter', () => {
            sentenceEl.style.boxShadow = '0 0 20px rgba(var(--primary-rgb), 0.3)';
        });
        
        sentenceEl.addEventListener('mouseleave', () => {
            sentenceEl.style.boxShadow = '';
        });
    </script>
</body>
</html>